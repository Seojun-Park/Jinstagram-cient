(this["webpackJsonpjinstagram-client"]=this["webpackJsonpjinstagram-client"]||[]).push([[0],{154:function(n,e,t){"use strict";t.r(e);var r=t(0),o=t(8),c=t(1),i=t(40),a=t.n(i),u=t(3),s=t(92),l=t(96),d=t(4);function b(){var n=Object(u.a)(["\n  extend type Query {\n    isLoggedIn: Boolean!\n  }\n"]);return b=function(){return n},n}var j=Object(o.gql)(b()),f=Object(o.makeVar)(!!localStorage.getItem("Bearer")),p=new o.InMemoryCache({typePolicies:{Query:{fields:{isLoggedIn:{read:function(){return f()}}}}}}),g=new o.ApolloLink((function(n,e){return n.setContext({headers:{Authorization:localStorage.getItem("Bearer")||""}}),e(n)})),x=new s.a({uri:"ws://localhost:4000/subscription",options:{reconnect:!0,lazy:!0,connectionParams:{Bearer:localStorage.getItem("Bearer")||""}}}),h=new o.HttpLink({uri:"http://localhost:4000/graphql"}),m=Object(l.a)((function(n){var e=n.graphqlErrors;n.networkError;e&&e.map((function(n){var e=n.message;return console.log("net work graphql error :",e)}))})),O=Object(o.split)((function(n){var e=n.query,t=Object(d.p)(e),r=t.kind,o=t.operation;return"OperationDefinition"===r&&"subscription"===o}),x,h),v=new o.ApolloClient({cache:p,link:o.ApolloLink.from([m,Object(o.concat)(g,O)]),headers:{authorization:localStorage.getItem("Bearer")||""},typeDefs:j}),w=t(5),k=t(19),y=t(15),C=t(25),S=t.n(C),I=t(33),P=t(41),$=t(7),N=t(16),L=t(60),F=(t(156),"AIzaSyA4NwaePp5gXgNcXDnCejP2vrfKz8mZCzs"),M={apiKey:"AIzaSyANPA73ldSYuvfCD7vAxt_1IMIFgSUHSC0",authDomain:"jinsta-storage.firebaseapp.com",databaseURL:"https://jinsta-storage.firebaseio.com",projectId:"jinsta-storage",storageBucket:"jinsta-storage.appspot.com",messagingSenderId:"374149106517",appId:"1:374149106517:web:aa23e6a0e3ce4014fdbddc",measurementId:"G-9HXYJBLQW2"};L.a.initializeApp(M);var q=L.a.storage(),z=t(97),E=t.n(z),A=function(){var n=Object(I.a)(S.a.mark((function n(e,t,r){var o,c,i;return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o="https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(e,",").concat(t,"&key=").concat(F),n.prev=1,n.next=4,E.a.get(o);case 4:(c=n.sent)?r(null===(i=c.data)||void 0===i?void 0:i.results[0].address_components[2].long_name):console.log(" no response"),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e,t,r){return n.apply(this,arguments)}}();function U(){var n=Object(u.a)(["\n  query GetChat {\n    GetChat {\n      ok\n      err\n      chat {\n        id\n        from {\n          id\n          profilePhoto\n          username\n        }\n        to {\n          id\n          profilePhoto\n          username\n        }\n        messages {\n          user {\n            id\n            username\n          }\n          text\n          createdAt\n        }\n      }\n    }\n  }\n"]);return U=function(){return n},n}function T(){var n=Object(u.a)(["\n  query SearchUser($term: String!) {\n    SearchUser(term: $term) {\n      ok\n      err\n      users {\n        id\n        username\n        profilePhoto\n      }\n    }\n  }\n"]);return T=function(){return n},n}function D(){var n=Object(u.a)(["\n  query SeeUser($username: String!) {\n    SeeUser(username: $username) {\n      ok\n      err\n      user {\n        id\n        email\n        profilePhoto\n        firstName\n        lastName\n        username\n        isFollowing\n        intro\n        following {\n          id\n          username\n          firstName\n          lastName\n        }\n        followers {\n          id\n          username\n          firstName\n          profilePhoto\n          lastName\n        }\n        posts {\n          id\n          caption\n          location\n          images {\n            url\n          }\n        }\n        comments {\n          id\n        }\n        likes {\n          id\n        }\n      }\n    }\n  }\n"]);return D=function(){return n},n}function G(){var n=Object(u.a)(["\n  query Me {\n    Me {\n      ok\n      err\n      user {\n        id\n        email\n        profilePhoto\n        firstName\n        lastName\n        username\n        intro\n        chatTo {\n          id\n          to {\n            id\n            username\n            profilePhoto\n          }\n          from {\n            id\n            username\n            profilePhoto\n          }\n          messages {\n            text\n            user {\n              username\n            }\n          }\n        }\n        chatFrom {\n          id\n          to {\n            id\n            username\n            profilePhoto\n          }\n          from {\n            id\n            username\n            profilePhoto\n          }\n          messages {\n            text\n            user {\n              username\n            }\n          }\n        }\n        posts {\n          id\n        }\n      }\n    }\n  }\n"]);return G=function(){return n},n}var B=Object(o.gql)(G()),Q=Object(o.gql)(D()),R=Object(o.gql)(T()),H=(Object(o.gql)(U()),t(17)),W=function(){return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:Object(r.jsx)("path",{d:"M6.28 3c3.236.001 4.973 3.491 5.72 5.031.75-1.547 2.469-5.021 5.726-5.021 2.058 0 4.274 1.309 4.274 4.182 0 3.442-4.744 7.851-10 13-5.258-5.151-10-9.559-10-13 0-2.676 1.965-4.193 4.28-4.192zm.001-2c-3.183 0-6.281 2.187-6.281 6.192 0 4.661 5.57 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-4.011-3.097-6.182-6.274-6.182-2.204 0-4.446 1.042-5.726 3.238-1.285-2.206-3.522-3.248-5.719-3.248z"})})},Y=function(){return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#ED4956",children:Object(r.jsx)("path",{d:"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z"})})},_=function(){return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:Object(r.jsx)("path",{d:"M12 3c5.514 0 10 3.476 10 7.747 0 4.272-4.48 7.748-9.986 7.748-.62 0-1.092-.046-1.759-.097-1 .776-1.774 1.403-3.485 1.962.26-1.383-.113-2.259-.514-3.259-2.383-1.505-4.256-3.411-4.256-6.354 0-4.271 4.486-7.747 10-7.747zm0-2c-6.627 0-12 4.363-12 9.747 0 3.13 1.816 5.916 4.641 7.699.867 2.167-1.084 4.008-3.143 4.502 3.085.266 6.776-.481 9.374-2.497 7.08.54 13.128-3.988 13.128-9.704 0-5.384-5.373-9.747-12-9.747z"})})},X=function(){return Object(r.jsx)("svg",{version:"1.0",xmlns:"http://www.w3.org/2000/svg",width:"36",height:"36",viewBox:"0 0 1200 1200",preserveAspectRatio:"xMidYMid meet",children:Object(r.jsxs)("g",{transform:"translate(0.000000,1200.000000) scale(0.100000,-0.100000)",fill:"#000000",stroke:"none",children:[Object(r.jsx)("path",{d:"M2457 8082 l-2057 -2057 0 -843 0 -842 2060 0 2060 0 0 -1035 0\n-1035 1035 0 1035 0 0 1875 0 1875 -2049 2 -2049 3 2050 2058 2050 2057 -1038\n0 -1039 0 -2058 -2058z"}),Object(r.jsx)("path",{d:"M7470 9105 c0 -569 2 -1035 4 -1035 3 0 466 462 1030 1028 l1025\n1027 1 -1025 0 -1025 -1030 -1030 -1030 -1030 0 -1032 0 -1033 2065 0 2065 0\n0 1037 0 1038 -1030 -1030 -1030 -1030 0 1020 0 1020 1030 1030 1030 1030 0\n1037 0 1038 -2065 0 -2065 0 0 -1035z"})]})})},J=function(){return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:Object(r.jsx)("path",{d:"M9 12c0-.552.448-1 1.001-1s.999.448.999 1-.446 1-.999 1-1.001-.448-1.001-1zm6.2 0l-1.7 2.6-1.3-1.6-3.2 4h10l-3.8-5zm5.8-7v-2h-21v15h2v-13h19zm3 2v14h-20v-14h20zm-2 2h-16v10h16v-10z"})})},K=function(){return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:Object(r.jsx)("path",{d:"M20.944 12.979c-.489 4.509-4.306 8.021-8.944 8.021-2.698 0-5.112-1.194-6.763-3.075l1.245-1.633c1.283 1.645 3.276 2.708 5.518 2.708 3.526 0 6.444-2.624 6.923-6.021h-2.923l4-5.25 4 5.25h-3.056zm-15.864-1.979c.487-3.387 3.4-6 6.92-6 2.237 0 4.228 1.059 5.51 2.698l1.244-1.632c-1.65-1.876-4.061-3.066-6.754-3.066-4.632 0-8.443 3.501-8.941 8h-3.059l4 5.25 4-5.25h-2.92z"})})},V=function(){return Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:Object(r.jsx)("path",{d:"M7 11c-.828 0-1.5-.671-1.5-1.5s.672-1.5 1.5-1.5c.829 0 1.5.671 1.5 1.5s-.671 1.5-1.5 1.5zm5 0c-.828 0-1.5-.671-1.5-1.5s.672-1.5 1.5-1.5c.829 0 1.5.671 1.5 1.5s-.671 1.5-1.5 1.5zm5 0c-.828 0-1.5-.671-1.5-1.5s.672-1.5 1.5-1.5c.829 0 1.5.671 1.5 1.5s-.671 1.5-1.5 1.5zm5-8v13h-11.643l-4.357 3.105v-3.105h-4v-13h20zm2-2h-24v16.981h4v5.019l7-5.019h13v-16.981z"})})};function Z(){var n=Object(u.a)(["\n  width: 50px;\n  height: 50px;\n  object-fit: cover;\n  border-radius: 10rem;\n"]);return Z=function(){return n},n}function nn(){var n=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return nn=function(){return n},n}function en(){var n=Object(u.a)(["\n  padding-left: 30px;\n  font-weight: 600;\n"]);return en=function(){return n},n}function tn(){var n=Object(u.a)(["\n  padding-top: 25px;\n  font-weight: 600px;\n"]);return tn=function(){return n},n}function rn(){var n=Object(u.a)(["\n  height: 80px;\n  width: 300px;\n  padding-left: 20px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  cursor: pointer;\n  &:hover {\n    background-color: #eee;\n  }\n"]);return rn=function(){return n},n}function on(){var n=Object(u.a)(["\n  text-decoration: none;\n  color: black;\n"]);return on=function(){return n},n}function cn(){var n=Object(u.a)(["\n  position: absolute;\n  min-height: 10vh;\n  width: 320px;\n  background-color: white;\n  border-radius: 4px;\n  text-align: center;\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);\n  top: 8%;\n"]);return cn=function(){return n},n}function an(){var n=Object(u.a)(["\n  padding: 12px 12px;\n  width: 300px;\n  border-radius: 4px;\n  border: none;\n  background-color: #e6e6e6;\n  text-align: center;\n"]);return an=function(){return n},n}function un(){var n=Object(u.a)(["\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 0 25px;\n  max-width: 400px;\n"]);return un=function(){return n},n}function sn(){var n=Object(u.a)(["\n  width: 100%;\n  height: 4rem;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n"]);return sn=function(){return n},n}var ln=w.b.div(sn()),dn=w.b.div(un()),bn=w.b.input(an()),jn=w.b.div(cn()),fn=Object(w.b)(k.c)(on()),pn=w.b.div(rn()),gn=w.b.div(tn()),xn=w.b.span(en()),hn=Object(w.b)(k.c)(nn()),mn=w.b.img(Z()),On=function(n){var e=Object(c.useState)(n),t=Object($.a)(e,2),r=t[0],o=t[1];return[r,function(n){var e=n.target.value;o(e)},o]},vn=function(n){var e=n.url,t=Object(c.useState)(),i=Object($.a)(t,2),a=i[0],u=i[1],s=Object(c.useState)(!1),l=Object($.a)(s,2),d=l[0],b=l[1],j=On(""),f=Object($.a)(j,2),p=f[0],g=f[1],x=Object(c.useState)([]),h=Object($.a)(x,2),m=h[0],O=h[1],v=Object(o.useQuery)(B,{onCompleted:function(n){var e=n.Me,t=e.ok,r=e.err,o=e.user;t&&o?u(o):console.log(r)}}).loading;return Object(o.useQuery)(R,{skip:""===p,variables:{term:p},onCompleted:function(n){var e=n.SearchUser,t=e.ok,r=e.err,o=e.users;t&&o?(O(o),b(!0)):console.log(r)}}),Object(c.useEffect)((function(){var n=function(){b(!1)};if(d)return document.addEventListener("click",n),function(){return document.removeEventListener("click",n)}}),[d,b]),v||!a?Object(r.jsx)(r.Fragment,{children:"loading..."}):Object(r.jsxs)(ln,{children:[Object(r.jsx)(dn,{children:Object(r.jsx)(k.c,{to:"/",children:Object(r.jsx)(X,{})})}),Object(r.jsxs)(dn,{children:[Object(r.jsx)(bn,{type:"text",placeholder:"Search",value:p,onChange:g}),d?m&&m.length?Object(r.jsx)(jn,{children:m.map((function(n,e){return Object(r.jsx)(fn,{to:"/profile/".concat(n.username),children:Object(r.jsxs)(pn,{children:[Object(r.jsx)(mn,{src:n.profilePhoto,alt:n.username}),Object(r.jsx)(xn,{children:n.username})]})},e)}))}):Object(r.jsx)(jn,{children:Object(r.jsx)(gn,{children:"No user found"})}):""]}),Object(r.jsx)(dn,{children:Object(r.jsx)(hn,{to:"/profile/".concat(a.username),children:Object(r.jsx)(mn,{src:"".concat(e),alt:"profile"})})})]})};function wn(){var n=Object(u.a)(["\n  display: inline-block;\n  animation: "," 2s linear infinite;\n  font-size: 1.2rem;\n"]);return wn=function(){return n},n}function kn(){var n=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return kn=function(){return n},n}function yn(){var n=Object(u.a)(["\n    from{\n        transform: rotate(0deg);\n    }\n    to {\n        transform: rotate(360deg);\n    }\n"]);return yn=function(){return n},n}var Cn=Object(w.c)(yn()),Sn=w.b.div(kn()),In=w.b.div(wn(),Cn),Pn=function(){return Object(r.jsx)(Sn,{children:Object(r.jsx)(In,{children:Object(r.jsx)(K,{})})})};function $n(){var n=Object(u.a)(["\n  text-decoration: none;\n"]);return $n=function(){return n},n}function Nn(){var n=Object(u.a)(["\n  margin: 10px 0px;\n"]);return Nn=function(){return n},n}function Ln(){var n=Object(u.a)(["\n  margin-bottom: 7px;\n  span {\n    margin-right: 5px;\n  }\n"]);return Ln=function(){return n},n}function Fn(){var n=Object(u.a)(["\n  margin-top: 10px;\n  list-style: none;\n"]);return Fn=function(){return n},n}function Mn(){var n=Object(u.a)(["\n  border: none;\n  width: 100%;\n  resize: none;\n  font-size: 14px;\n  &:focus {\n    outline: none;\n  }\n"]);return Mn=function(){return n},n}function qn(){var n=Object(u.a)(["\n  font-weight: 400;\n  text-transform: uppercase;\n  opacity: 0.5;\n  display: block;\n  font-size: 12px;\n  margin: 10px 0px;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #003569;\n"]);return qn=function(){return n},n}function zn(){var n=Object(u.a)(["\n  "," {\n    &:first-child {\n      margin-right: 10px;\n    }\n  }\n  margin-bottom: 10px;\n"]);return zn=function(){return n},n}function En(){var n=Object(u.a)(["\n  padding: 15px;\n"]);return En=function(){return n},n}function An(){var n=Object(u.a)(["\n  cursor: pointer;\n"]);return An=function(){return n},n}function Un(){var n=Object(u.a)(["\n  border: none;\n  background-color: ",";\n  border-radius: 10rem;\n  height: 10px;\n  width: 10px;\n  cursor: pointer;\n"]);return Un=function(){return n},n}function Tn(){var n=Object(u.a)(["\n  position: absolute;\n  z-index: 1;\n  bottom: 3%;\n  left: 45%;\n  width: 60px;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-around;\n  align-items: center;\n"]);return Tn=function(){return n},n}function Dn(){var n=Object(u.a)(["\n  max-width: 100%;\n  width: 100%;\n  position: absolute;\n  height: 500px;\n  top: 0;\n  background-image: url(",");\n  background-size: cover;\n  background-position: center;\n  opacity: ",";\n  transition: opacity 0.5s linear;\n"]);return Dn=function(){return n},n}function Gn(){var n=Object(u.a)(["\n  position: relative;\n  padding-bottom: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  flex-shrink: 0;\n"]);return Gn=function(){return n},n}function Bn(){var n=Object(u.a)(["\n  display: block;\n  margin-top: 5px;\n  font-size: 12px;\n"]);return Bn=function(){return n},n}function Qn(){var n=Object(u.a)(["\n  text-decoration: none;\n"]);return Qn=function(){return n},n}function Rn(){var n=Object(u.a)(["\n  margin-left: 10px;\n"]);return Rn=function(){return n},n}function Hn(){var n=Object(u.a)(["\n  width: 50px;\n  height: 50px;\n  object-fit: cover;\n  border-radius: 10rem;\n"]);return Hn=function(){return n},n}function Wn(){var n=Object(u.a)(["\n  padding: 15px;\n  display: flex;\n  align-items: center;\n"]);return Wn=function(){return n},n}function Yn(){var n=Object(u.a)(["\n  width: 100%;\n  border: 1px solid #e6e6e6;\n  border-radius: 4px;\n  background-color: white;\n  width: 500px;\n  user-select: none;\n  margin-bottom: 25px;\n  a {\n    color: inherit;\n  }\n"]);return Yn=function(){return n},n}var _n=w.b.div(Yn()),Xn=w.b.header(Wn()),Jn=w.b.img(Hn()),Kn=w.b.div(Rn()),Vn=Object(w.b)(k.c)(Qn()),Zn=w.b.span(Bn()),ne=w.b.div(Gn()),ee=w.b.div(Dn(),(function(n){return n.url}),(function(n){return n.showing?1:0})),te=w.b.div(Tn()),re=w.b.button(Un(),(function(n){return n.current?"#e6e6e6":"gray"})),oe=w.b.span(An()),ce=w.b.div(En()),ie=w.b.div(zn(),oe),ae=w.b.span(qn()),ue=w.b.input(Mn()),se=w.b.ul(Fn()),le=w.b.li(Ln()),de=w.b.div(Nn()),be=Object(w.b)(k.c)($n()),je=function(n){var e=n.posts,t=n.currentItem,o=n.setCurrentItem,c=n.isLiked,i=(n.setIsLiked,n.handleToggleLike),a=n.likeCount,u=n.comment,s=n.commentChange,l=n.commentS,d=n.me,b=Math.floor(e.createdAt/1e3),j=new Date(b*=1e3),f=j.getFullYear(),p=j.getMonth()+1,g=j.getDate(),x=j.getHours(),h=j.getMinutes();return Object(r.jsxs)(_n,{children:[Object(r.jsxs)(Xn,{children:[Object(r.jsx)(Jn,{src:e.user.profilePhoto}),Object(r.jsxs)(Kn,{children:[Object(r.jsx)(Vn,{to:{pathname:"/profile",state:{id:e.user.id}},children:Object(r.jsx)("span",{style:{fontWeight:600},children:e.user.username})}),Object(r.jsx)(Zn,{children:e.location})]})]}),Object(r.jsxs)(ne,{children:[e.images&&e.images.map((function(n,e){return Object(r.jsx)(ee,{url:n.url,showing:e===t},e)})),Object(r.jsx)(te,{children:e.images&&e.images.map((function(n,e){return Object(r.jsx)(re,{onClick:function(){return o(e)},current:e===t},e)}))})]}),Object(r.jsxs)(ce,{children:[Object(r.jsxs)(ie,{children:[Object(r.jsx)(oe,{onClick:i,children:c?Object(r.jsx)(Y,{}):Object(r.jsx)(W,{})}),Object(r.jsx)(oe,{children:Object(r.jsx)(_,{})})]}),1===a?Object(r.jsx)("span",{style:{fontWeight:600},children:"1 like"}):Object(r.jsxs)("span",{style:{fontWeight:600},children:[a," likes"]}),Object(r.jsxs)(de,{children:[Object(r.jsx)(be,{to:"/profile/".concat(e.user.username),style:{fontWeight:600},children:e.user.username})," ",e.caption]}),e.comments&&Object(r.jsxs)(se,{children:[e.comments.map((function(n,e){return Object(r.jsxs)(le,{children:[Object(r.jsx)(be,{to:"/profile/".concat(n.user.username),style:{fontWeight:600},children:n.user.username})," ",n.text]},e)})),l&&0!==l.length&&l.map((function(n,e){return Object(r.jsxs)(le,{children:[Object(r.jsx)(be,{to:"/profile/".concat(d.username),style:{fontWeight:600},children:d.username})," ",n]},e)}))]}),Object(r.jsx)(ae,{children:"".concat(f,".").concat(p,".").concat(g," ").concat(x,":").concat(h)}),Object(r.jsx)(ue,{placeholder:"Add a comment...",value:u,onChange:s})]})]})};function fe(){var n=Object(u.a)(["\n  query GetLike($postId: Int!) {\n    GetLike(postId: $postId) {\n      ok\n      err\n      likes {\n        id\n        userId\n      }\n    }\n  }\n"]);return fe=function(){return n},n}function pe(){var n=Object(u.a)(["\n  query GetPost($postId: Int!) {\n    GetPost(postId: $postId) {\n      ok\n      err\n      post {\n        id\n        likes {\n          id\n          userId\n        }\n      }\n    }\n  }\n"]);return pe=function(){return n},n}function ge(){var n=Object(u.a)(["\n  mutation AddComment($text: String!, $postId: Int!) {\n    AddComment(text: $text, postId: $postId) {\n      ok\n      err\n    }\n  }\n"]);return ge=function(){return n},n}function xe(){var n=Object(u.a)(["\n  mutation ToggleLike($postId: Int!) {\n    ToggleLike(postId: $postId) {\n      ok\n      err\n      ret\n    }\n  }\n"]);return xe=function(){return n},n}var he=Object(o.gql)(xe()),me=Object(o.gql)(ge()),Oe=(Object(o.gql)(pe()),Object(o.gql)(fe()));function ve(){var n=Object(u.a)(["\n  query GetFullPost($page: Int!) {\n    GetFullPost(page: $page) {\n      ok\n      err\n      post {\n        id\n        caption\n        location\n        isLiked\n        user {\n          id\n          username\n          profilePhoto\n        }\n        images {\n          id\n          url\n        }\n        comments {\n          id\n          text\n          user {\n            id\n            username\n          }\n          createdAt\n        }\n        likes {\n          id\n          userId\n        }\n        createdAt\n      }\n    }\n  }\n"]);return ve=function(){return n},n}function we(){var n=Object(u.a)(["\n  mutation UploadPost($location: String, $caption: String, $images: [String]) {\n    UploadPost(location: $location, caption: $caption, images: $images) {\n      ok\n      err\n    }\n  }\n"]);return we=function(){return n},n}var ke=Object(o.gql)(we()),ye=Object(o.gql)(ve()),Ce=function(n){var e=n.posts,t=n.me,i=Object(c.useState)(0),a=Object($.a)(i,2),u=a[0],s=a[1],l=Object(c.useState)([]),d=Object($.a)(l,2),b=d[0],j=d[1],f=Object(c.useState)(e.likes.length),p=Object($.a)(f,2),g=p[0],x=p[1],h=Object(c.useState)([]),m=Object($.a)(h,2),O=m[0],v=m[1],w=On(""),k=Object($.a)(w,3),y=k[0],C=k[1],N=k[2],L=Object(c.useState)(!(!b||!t||b.userId!==t.id)),F=Object($.a)(L,2),M=F[0],q=F[1],z=Object(o.useMutation)(he,{variables:{postId:e.id},onCompleted:function(n){var e=n.ToggleLike,t=e.ok,r=e.err,o=e.ret;t&&o?"DEL"===o?x(g-1):"CRA"===o&&x(g+1):console.log(r)}}),E=Object($.a)(z,1)[0],A=Object(o.useLazyQuery)(Oe,{onCompleted:function(n){var e=n.GetLike,t=e.ok,r=e.err,o=e.likes;t&&o?j(o):console.log(r)}}),U=Object($.a)(A,2),T=U[0],D=U[1].loading;Object(c.useEffect)((function(){e.id&&T({variables:{postId:e.id}})}),[T,e.id]),Object(c.useEffect)((function(){if(b){var n=b.findIndex((function(n){return n.userId===t.id}));void 0!==b[n]?q(!0):q(!1)}}),[b,t,q]);var G=Object(o.useMutation)(me,{variables:{text:y,postId:e.id},onCompleted:function(n){var e=n.AddComment,t=e.ok,r=e.err;t?(v([].concat(Object(P.a)(O),[y])),N("")):console.log(r)},refetchQueries:[{query:ye,variables:{page:1}}]}),B=Object($.a)(G,1)[0],Q=function(){var n=Object(I.a)(S.a.mark((function n(e){return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.next=3,E();case 3:q(!M);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),R=Object(c.useCallback)((function(n){13===n.keyCode&&B()}),[B]);return Object(c.useEffect)((function(){if(""!==y)return document.addEventListener("keydown",R),function(){document.removeEventListener("keydown",R)}}),[y,R]),!D&&t&&b?Object(r.jsx)(je,{posts:e,currentItem:u,setCurrentItem:s,isLiked:M,setIsLiked:q,handleToggleLike:Q,likeCount:g,comment:y,commentChange:C,commentS:O,me:t}):Object(r.jsx)(r.Fragment,{children:"loading..."})},Se=t(61),Ie=t(102),Pe=t.n(Ie);function $e(){var n=Object(u.a)(["\n  width: 60px;\n  padding: 10px 0;\n  border-radius: 4px;\n  border: none;\n  background-color: #3498db;\n  color: white;\n  cursor: pointer;\n"]);return $e=function(){return n},n}function Ne(){var n=Object(u.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding-right: 15px;\n"]);return Ne=function(){return n},n}function Le(){var n=Object(u.a)(["\n  background-color: #fff;\n  margin: 15px;\n  cursor: pointer;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  border-radius: 8px;\n"]);return Le=function(){return n},n}function Fe(){var n=Object(u.a)(["\n  border: none;\n  border-bottom: 1px solid #c7c7c7;\n  height: 70px;\n  width: 100%;\n  resize: none;\n  font-size: 14px;\n  &:focus {\n    outline: none;\n  }\n"]);return Fe=function(){return n},n}function Me(){var n=Object(u.a)(["\n  width: 100%;\n  border: 1px solid #e6e6e6;\n  padding: 15px;\n  height: 120px;\n  border-radius: 4px;\n  max-width: 470px;\n  margin-bottom: 25px;\n"]);return Me=function(){return n},n}function qe(){var n=Object(u.a)(["\n  margin: 50px auto;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  max-width: 600px;\n"]);return qe=function(){return n},n}function ze(){var n=Object(u.a)([""]);return ze=function(){return n},n}var Ee=w.b.div(ze()),Ae=w.b.div(qe()),Ue=w.b.div(Me()),Te=Object(w.b)(Pe.a)(Fe()),De=w.b.div(Le()),Ge=w.b.div(Ne()),Be=w.b.button($e()),Qe=function(n){var e=n.me,t=n.posts,o=n.page,i=n.setPage,a=n.handleUpload,u=n.progress,s=n.flag,l=n.caption,d=n.setCaption,b=n.handlePost,j=Object(Se.a)({accept:"image/png, image/jpeg"}),f=j.getRootProps,p=j.getInputProps;return Object(c.useEffect)((function(){var n=function(){window.innerHeight+document.documentElement.scrollTop===document.documentElement.offsetHeight&&i(o+1)};return window.addEventListener("scroll",n),function(){return window.removeEventListener("scroll",n)}}),[o,i]),Object(r.jsxs)(Ee,{children:[Object(r.jsx)(vn,{url:e.profilePhoto}),Object(r.jsxs)(Ae,{children:[Object(r.jsxs)(Ue,{children:[Object(r.jsx)(Te,{placeholder:"Add a caption",value:l,onChange:d}),Object(r.jsxs)(Ge,{children:[Object(r.jsxs)(De,Object(H.a)(Object(H.a)({},f()),{},{children:[Object(r.jsx)("input",Object(H.a)(Object(H.a)({},p()),{},{onChange:a})),s?100!==u?Object(r.jsx)(Pn,{}):"":Object(r.jsx)(J,{})]})),s&&100!==u?Object(r.jsx)(Pn,{}):Object(r.jsx)(Be,{onClick:function(){return b()},children:"Upload"})]})]}),t&&t.map((function(n,t){return Object(r.jsx)(Ce,{posts:n,me:e},t)}))]})]})},Re=function(){var n=Object(c.useState)(),e=Object($.a)(n,2),t=e[0],i=e[1],a=Object(c.useState)(!1),u=Object($.a)(a,2),s=u[0],l=u[1],d=Object(c.useState)(),b=Object($.a)(d,2),j=b[0],f=b[1],p=On(""),g=Object($.a)(p,2),x=g[0],h=g[1],m=Object(c.useState)([]),O=Object($.a)(m,2),v=O[0],w=O[1],k=Object(c.useState)(1),y=Object($.a)(k,2),C=y[0],L=y[1],F=Object(c.useState)(1),M=Object($.a)(F,2),z=M[0],E=M[1],U=Object(c.useState)(),T=Object($.a)(U,2),D=T[0],G=T[1],Q=Object(c.useState)(0),R=Object($.a)(Q,2),H=R[0],W=R[1],Y=Object(c.useState)(0),_=Object($.a)(Y,2),X=_[0],J=_[1],K=Object(c.useState)(""),V=Object($.a)(K,2),Z=V[0],nn=V[1],en=Object(o.useQuery)(B,{onCompleted:function(n){var e=n.Me,t=e.ok,r=e.err,o=e.user;t&&o?i(o):r&&N.b.error(r)}}).loading;Object(o.useQuery)(ye,{fetchPolicy:"network-only",variables:{page:z},onCompleted:function(n){var e=n.GetFullPost,t=e.ok,r=e.err,o=e.post;t&&o?G(o):console.log(r)}});var tn=Object(o.useMutation)(ke,{variables:{caption:x,location:Z,images:v},refetchQueries:[{query:ye,variables:{page:1}}],onCompleted:function(n){var e=n.UploadPost,t=e.ok,r=e.err;t?window.location.reload():console.log(r)}}),rn=Object($.a)(tn,1)[0];Object(c.useEffect)((function(){if(s&&t&&j)for(var n=function(n){q.ref("/".concat(t.username,"/images/").concat(j[n].name)).put(j[n]).on("state_changed",(function(n){var e=Math.round(n.bytesTransferred/n.totalBytes*100);L(e)}),(function(n){console.log(n)}),(function(){q.ref("/".concat(t.username,"/images/")).child("".concat(j[n].name)).getDownloadURL().then((function(n){w((function(e){return[].concat(Object(P.a)(e),[n])}))}))}))},e=0;e<j.length;e++)n(e)}),[s,t,j]),Object(c.useEffect)((function(){var n=setInterval((function(){navigator.geolocation.getCurrentPosition((function(n){n&&n.coords&&(W(n.coords.latitude),J(n.coords.longitude))}))}),500);return function(){return clearInterval(n)}}),[W,J]),Object(c.useEffect)((function(){0!==H&&0!==X&&A(H,X,nn)}),[H,X,nn]);var on=function(){var n=Object(I.a)(S.a.mark((function n(){return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(v||""!==x){n.next=4;break}N.b.error("You need to upload any photo and caption"),n.next=7;break;case 4:if(!v||!x){n.next=7;break}return n.next=7,rn();case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return en||void 0===t?Object(r.jsx)(r.Fragment,{children:"Loading..."}):Object(r.jsx)(Qe,{me:t,posts:D,flag:s,progress:C,page:z,setPage:E,handleUpload:function(n){n.preventDefault(),n.target&&n.target.files&&null!==n.target&&n.target.files&&null!==n.target.files.length&&(f(n.target.files),l(!0))},caption:x,setCaption:h,handlePost:on})};function He(){var n=Object(u.a)(["\n  query isLoggedIn {\n    isLoggedIn @client\n  }\n"]);return He=function(){return n},n}var We=Object(o.gql)(He()),Ye=function(n){v.cache.writeQuery({query:We,data:{isLoggedIn:!0}}),localStorage.setItem("Bearer",n),f(!0)};function _e(){var n=Object(u.a)(["\n  color: #c7c7c7;\n"]);return _e=function(){return n},n}function Xe(){var n=Object(u.a)(["\n  color: #c7c7c7;\n"]);return Xe=function(){return n},n}function Je(){var n=Object(u.a)(["\n  &:not(:last-child) {\n    margin-right: 16px;\n  }\n"]);return Je=function(){return n},n}function Ke(){var n=Object(u.a)(["\n  display: flex;\n"]);return Ke=function(){return n},n}function Ve(){var n=Object(u.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  text-transform: uppercase;\n  font-size: 12px;\n  font-weight: 600px;\n"]);return Ve=function(){return n},n}var Ze=w.b.div(Ve()),nt=(w.b.ul(Ke()),w.b.li(Je()),w.b.a(Xe()),w.b.span(_e())),et=function(){return Object(r.jsx)(Ze,{children:Object(r.jsxs)(nt,{children:["Jinstagram ",(new Date).getFullYear(),"\xa9"]})})},tt=t(103),rt=t.p+"static/media/logo.99d65aab.png";function ot(){var n=Object(u.a)(["\n  padding: 12px 12px;\n  width: 200px;\n  border-radius: 4px;\n  border: none;\n  background-color: #e6e6e6;\n  text-align: center;\n  &:not(:last-child) {\n    margin-bottom: 15px;\n  }\n"]);return ot=function(){return n},n}function ct(){var n=Object(u.a)(["\n  cursor: pointer;\n  color: #3498db;\n"]);return ct=function(){return n},n}function it(){var n=Object(u.a)(["\n  margin-top: 15px;\n  width: 215px;\n  padding: 18px 0;\n  border: none;\n  background-color: #ff3e30;\n  text-transform: uppercase;\n  font-size: 15px;\n  font-weight: 500;\n  color: white;\n  cursor: pointer;\n"]);return it=function(){return n},n}function at(){var n=Object(u.a)(["\n  border-top: 1px solid #c7c7c7;\n  width: 300px;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  padding-top: 15px;\n"]);return at=function(){return n},n}function ut(){var n=Object(u.a)(["\n  padding-top: 15px;\n"]);return ut=function(){return n},n}function st(){var n=Object(u.a)(["\n  margin-top: 15px;\n  width: 225px;\n  padding: 10px 0;\n  border-radius: 4px;\n  border: none;\n  background-color: #3498db;\n  color: white;\n  cursor: pointer;\n"]);return st=function(){return n},n}function lt(){var n=Object(u.a)(["\n  padding: 12px 12px;\n  width: 200px;\n  border-radius: 4px;\n  border: none;\n  background-color: #e6e6e6;\n  text-align: center;\n"]);return lt=function(){return n},n}function dt(){var n=Object(u.a)(["\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 15px;\n"]);return dt=function(){return n},n}function bt(){var n=Object(u.a)(["\n  padding: 12px;\n  margin-bottom: 25px;\n"]);return bt=function(){return n},n}function jt(){var n=Object(u.a)(["\n  font-size: 24px;\n  color: #999;\n  font-weight: 600;\n"]);return jt=function(){return n},n}function ft(){var n=Object(u.a)(["\n  width: 80px;\n  height: 80px;\n  object-fit: contain;\n"]);return ft=function(){return n},n}function pt(){var n=Object(u.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return pt=function(){return n},n}function gt(){var n=Object(u.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  /* height: 60vh; */\n  width: 350px;\n  padding-top: 25px;\n  padding-bottom: 25px;\n  margin-bottom: 40px;\n  margin-top: 150px;\n"]);return gt=function(){return n},n}function xt(){var n=Object(u.a)(["\n  height: 90vh;\n  width: 90vw;\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n  align-items: center;\n  max-width: 935px;\n  margin: 0 auto;\n"]);return xt=function(){return n},n}function ht(){var n=Object(u.a)(["\n  border: 1px solid #e6e6e6;\n  border-radius: 4px;\n  background-color: white;\n"]);return ht=function(){return n},n}var mt=w.b.div(ht()),Ot=w.b.div(xt()),vt=Object(w.b)(mt)(gt()),wt=w.b.div(pt()),kt=w.b.img(ft()),yt=w.b.span(jt()),Ct=w.b.div(bt()),St=w.b.form(dt()),It=w.b.input(lt()),Pt=w.b.button(st()),$t=w.b.span(ut()),Nt=w.b.div(at()),Lt=w.b.button(it()),Ft=w.b.span(ct()),Mt=w.b.input(ot()),qt=t(106),zt=t.n(qt),Et=t(107),At=t.n(Et),Ut=function(n){var e=n.action,t=n.setAction,o=n.secret,c=n.secretChange,i=n.email,a=n.emailChange,u=n.onSubmit,s=n.setGoogleId,l=n.setFbId,d=n.setProfilePhoto,b=n.setSocialEmail,j=n.setLastName,f=n.setFirstName,p=n.setUserName,g=n.setIntro,x=n.setSignUpFirstName,h=n.setSignUpLastName,m=n.username,O=n.intro,v=n.signUpFirstName,w=n.signUpLastName,k=n.FacebookLoginMutation,y=n.GoogleLoginMutatation,C=function(n){var e=n.profileObj,t=e.email,r=e.familyName,o=e.givenName,c=e.googleId;void 0===t&&console.log("err"),f(o),j(r),s(c),b(t),y()};return Object(r.jsxs)(Ot,{children:[Object(r.jsx)(tt.a,{children:Object(r.jsx)("title",{children:"Auth | Jinstagram"})}),Object(r.jsxs)(vt,{children:[Object(r.jsxs)(wt,{children:[Object(r.jsx)(kt,{src:rt,alt:"logo"}),"login"===e&&Object(r.jsx)(yt,{children:"Login"})]}),"login"===e&&Object(r.jsxs)(Ct,{children:[Object(r.jsxs)(St,{onSubmit:u,children:[Object(r.jsx)(It,{placeholder:"Email",value:i,onChange:a,autoFocus:!0}),Object(r.jsx)(Pt,{children:"Login"})]}),Object(r.jsx)($t,{children:"Don't have an account? "}),Object(r.jsx)(Ft,{onClick:function(){return t("signup")},children:"Sign Up"})]}),"signup"===e&&Object(r.jsx)(Ct,{children:Object(r.jsxs)(St,{onSubmit:u,children:[Object(r.jsx)(Mt,{placeholder:"Email",value:i,onChange:a,autoFocus:!0}),Object(r.jsx)(Mt,{placeholder:"First Name",value:v,onChange:x,autoFocus:!0}),Object(r.jsx)(Mt,{placeholder:"Last Name",value:w,onChange:h,autoFocus:!0}),Object(r.jsx)(Mt,{placeholder:"Username",value:m,onChange:p,autoFocus:!0}),Object(r.jsx)(Mt,{placeholder:"intro",value:O,onChange:g,autoFocus:!0}),Object(r.jsx)(Pt,{children:"Confirm"})]})}),"confirm"===e&&Object(r.jsx)(Ct,{children:Object(r.jsxs)(St,{onSubmit:u,children:[Object(r.jsx)(Mt,{placeholder:"code",value:o,onChange:c,autoFocus:!0}),Object(r.jsx)(Pt,{children:"Confirm"})]})}),Object(r.jsxs)(Nt,{children:[Object(r.jsx)(zt.a,{appId:"306360554149080",fields:"name, email,picture",callback:function(n){var e=n.name,t=n.email,r=n.userID,o=n.picture;void 0===e?console.log("error"):(f(e.split(" ")[0]),j(e.split(" ")[e.split(" ").length-1]),b(t),l(r),d(o.data.url),k())}}),Object(r.jsx)(At.a,{render:function(n){return Object(r.jsx)(Lt,{onClick:n.onClick,disabled:n.disabled,children:"login with Google"})},clientId:"653597209706-g73v027q056idqi93oetg0bp8k1s3vtd.apps.googleusercontent.com",onSuccess:C,onFailure:C,cookiePolicy:"single_host_origin"})]})]}),Object(r.jsx)(et,{})]})};function Tt(){var n=Object(u.a)(["\n  mutation ConfirmSecret($email: String!, $code: String!) {\n    ConfirmSecret(email: $email, code: $code){\n      ok\n      err\n      token\n    }\n  }\n"]);return Tt=function(){return n},n}function Dt(){var n=Object(u.a)(["\n  mutation RequestCode($email: String!) {\n    RequestCode(email: $email) {\n      ok\n      err\n      code\n    }\n  }\n"]);return Dt=function(){return n},n}function Gt(){var n=Object(u.a)(["\n  mutation CreateAccount(\n    $username: String!\n    $email: String!\n    $firstName: String!\n    $lastName: String!\n    $intro: String!\n  ) {\n    CreateAccount(\n      username: $username\n      email: $email\n      firstName: $firstName\n      lastName: $lastName\n      intro: $intro\n    ) {\n      ok\n      err\n    }\n  }\n"]);return Gt=function(){return n},n}function Bt(){var n=Object(u.a)(["\n  mutation GoogleConnect(\n    $googleId: String!\n    $firstName: String!\n    $lastName: String!\n    $email: String!\n  ) {\n    GoogleConnect(\n      googleId: $googleId\n      firstName: $firstName\n      lastName: $lastName\n      email: $email\n    ) {\n      ok\n      err\n      token\n    }\n  }\n"]);return Bt=function(){return n},n}function Qt(){var n=Object(u.a)(["\n  mutation FacebookConnect(\n    $firstName: String!\n    $lastName: String!\n    $email: String!\n    $fbId: String!\n    $profilePhoto: String\n  ) {\n    FacebookConnect(\n      firstName: $firstName\n      lastName: $lastName\n      email: $email\n      fbId: $fbId\n      profilePhoto: $profilePhoto\n    ) {\n      ok\n      err\n      token\n    }\n  }\n"]);return Qt=function(){return n},n}var Rt=Object(o.gql)(Qt()),Ht=Object(o.gql)(Bt()),Wt=Object(o.gql)(Gt()),Yt=Object(o.gql)(Dt()),_t=Object(o.gql)(Tt()),Xt=function(){var n=On(""),e=Object($.a)(n,2),t=e[0],i=e[1],a=On(""),u=Object($.a)(a,2),s=u[0],l=u[1],d=On(""),b=Object($.a)(d,2),j=b[0],f=b[1],p=On(""),g=Object($.a)(p,2),x=g[0],h=g[1],m=On(""),O=Object($.a)(m,2),v=O[0],w=O[1],k=On(""),y=Object($.a)(k,2),C=y[0],P=y[1],L=Object(c.useState)("login"),F=Object($.a)(L,2),M=F[0],q=F[1],z=Object(c.useState)(""),E=Object($.a)(z,2),A=E[0],U=E[1],T=Object(c.useState)(""),D=Object($.a)(T,2),G=D[0],B=D[1],Q=Object(c.useState)(""),R=Object($.a)(Q,2),H=R[0],W=R[1],Y=Object(c.useState)(""),_=Object($.a)(Y,2),X=_[0],J=_[1],K=Object(c.useState)(""),V=Object($.a)(K,2),Z=V[0],nn=V[1],en=Object(c.useState)(""),tn=Object($.a)(en,2),rn=tn[0],on=tn[1],cn=Object(o.useMutation)(Rt,{variables:{firstName:A,lastName:G,email:H,fbId:Z,profilePhoto:X},onCompleted:function(n){var e=n.FacebookConnect,t=e.ok,r=e.err,o=e.token;t?o&&Ye(o):console.log(r)}}),an=Object($.a)(cn,1)[0],un=Object(o.useMutation)(Ht,{variables:{firstName:A,lastName:G,email:H,googleId:rn},onCompleted:function(n){var e=n.GoogleConnect,t=e.ok,r=e.err,o=e.token;t?o&&(Ye(o),N.b.success("Connected")):console.log(r)}}),sn=Object($.a)(un,1)[0],ln=Object(o.useMutation)(Wt,{variables:{firstName:v,lastName:C,email:t,intro:x,username:j},onCompleted:function(n){var e=n.CreateAccount,t=e.ok,r=e.err;t?(N.b.success("Account created!, now login"),setTimeout((function(){return q("login")}),2e3)):r&&N.b.error(r)}}),dn=Object($.a)(ln,1)[0],bn=Object(o.useMutation)(Yt,{variables:{email:t},onCompleted:function(n){var e=n.RequestCode,t=e.ok,r=e.err;t?(N.b.success("Secret code sent to your email"),setTimeout((function(){return q("confirm")}),500)):r&&N.b.error(r)}}),jn=Object($.a)(bn,1)[0],fn=Object(o.useMutation)(_t,{variables:{email:t,code:s},onCompleted:function(n){var e=n.ConfirmSecret,t=e.ok,r=e.err,o=e.token;t&&o?Ye(o):N.b.error(r)}}),pn=Object($.a)(fn,1)[0],gn=function(){var n=Object(I.a)(S.a.mark((function n(e){var r,o,c,i;return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.preventDefault(),"login"!==M){n.next=19;break}if(""===t){n.next=16;break}return n.prev=3,n.next=6,jn();case 6:r=n.sent,(null===(o=r.data)||void 0===o?void 0:o.RequestCode)?q("confirm"):(N.b.error("You don't have an account yet. Sign up now"),setTimeout((function(){return q("signup")}),2e3)),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),N.b.error("Requesting code is failed.");case 14:n.next=17;break;case 16:N.b.error("Email is required");case 17:n.next=47;break;case 19:if("signup"!==M){n.next=37;break}if(""===v||""===C||""===j||""===t||""===x){n.next=34;break}return n.prev=21,n.next=24,dn();case 24:c=n.sent,(null===(i=c.data)||void 0===i?void 0:i.CreateAccount)?setTimeout((function(){return q("login")})):N.b.error("Can't create an account"),n.next=32;break;case 29:n.prev=29,n.t1=n.catch(21),N.b.error(n.t1.message);case 32:n.next=35;break;case 34:N.b.error("all fields are required");case 35:n.next=47;break;case 37:if("confirm"!==M){n.next=47;break}if(""===s){n.next=47;break}return n.prev=39,n.next=42,pn();case 42:n.next=47;break;case 44:n.prev=44,n.t2=n.catch(39),N.b.error(n.t2);case 47:case"end":return n.stop()}}),n,null,[[3,11],[21,29],[39,44]])})));return function(e){return n.apply(this,arguments)}}();return Object(r.jsx)(Ut,{action:M,setAction:q,email:t,emailChange:i,onSubmit:gn,secret:s,secretChange:l,setGoogleId:on,setFbId:nn,setProfilePhoto:J,setSocialEmail:W,setLastName:B,setFirstName:U,setUserName:f,setIntro:h,setSignUpFirstName:w,setSignUpLastName:P,FacebookLoginMutation:an,GoogleLoginMutatation:sn,username:j,intro:x,signUpFirstName:v,signUpLastName:C})},Jt=t(27);function Kt(){var n=Object(u.a)(["\n  background-image: url(",");\n  background-size: cover;\n  margin: 3px;\n  height: 250px;\n  width: 250px;\n  cursor: pointer;\n  &:hover {\n    "," {\n      opacity: 1;\n    }\n  }\n"]);return Kt=function(){return n},n}function Vt(){var n=Object(u.a)(["\n  background-color: rgba(0, 0, 0, 0.6);\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  opacity: 0;\n  transition: opacity 0.3s linear;\n  svg {\n    fill: white;\n  }\n"]);return Vt=function(){return n},n}function Zt(){var n=Object(u.a)(["\n  width: 80%;\n  border-top: 3px solid #333;\n  padding-top: 50px;\n  display: grid;\n  grid-template-columns: repeat(3, 250px);\n  grid-template-rows: 250px;\n  grid-auto-rows: 250px;\n  justify-content: center;\n  margin-bottom: 50px;\n"]);return Zt=function(){return n},n}function nr(){var n=Object(u.a)(["\n  width: 180px;\n  padding: 10px 0;\n  border-radius: 4px;\n  border: none;\n  background-color: #3498db;\n  color: white;\n  cursor: pointer;\n  &:hover {\n    background-color: #2980b9;\n  }\n"]);return nr=function(){return n},n}function er(){var n=Object(u.a)(["\n  font-weight: 600;\n  font-size: 24px;\n  margin-right: 15px;\n"]);return er=function(){return n},n}function tr(){var n=Object(u.a)(["\n  background-color: white;\n  border: none;\n  cursor: pointer;\n"]);return tr=function(){return n},n}function rr(){var n=Object(u.a)(["\n  width: 150px;\n  height: 150px;\n  object-fit: cover;\n  border-radius: 10rem;\n"]);return rr=function(){return n},n}function or(){var n=Object(u.a)(["\n  width: 180px;\n  padding: 8px 0;\n  border-radius: 4px;\n  border: none;\n  background-color: #e74c3c;\n  color: white;\n  cursor: pointer;\n  text-align: center;\n  font-size: 14px;\n  &:hover {\n    background-color: #c0392b;\n  }\n"]);return or=function(){return n},n}function cr(){var n=Object(u.a)(["\n  margin-left: 45px;\n"]);return cr=function(){return n},n}function ir(){var n=Object(u.a)(["\n  font-size: 14px;\n"]);return ir=function(){return n},n}function ar(){var n=Object(u.a)(["\n  font-weight: 600;\n  font-size: 16px;\n"]);return ar=function(){return n},n}function ur(){var n=Object(u.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"]);return ur=function(){return n},n}function sr(){var n=Object(u.a)(["\n  margin-bottom: 8px;\n  display: flex;\n  flex-direction: row;\n  padding: 10px 0;\n  justify-content: center;\n  width: 180px;\n"]);return sr=function(){return n},n}function lr(){var n=Object(u.a)(["\n  margin-bottom: 8px;\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-end;\n  width: 180px;\n"]);return lr=function(){return n},n}function dr(){var n=Object(u.a)(["\n  width: 50%;\n"]);return dr=function(){return n},n}function br(){var n=Object(u.a)(["\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 20px;\n"]);return br=function(){return n},n}function jr(){var n=Object(u.a)(["\n  width: 60%;\n  min-width: 450px;\n  display: flex;\n  flex-direction: column;\n  padding-left: 25px;\n  padding-right: 25px;\n  min-height: 200px;\n"]);return jr=function(){return n},n}function fr(){var n=Object(u.a)(["\n  width: 100%;\n  min-width: 500px;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  margin: 0 auto;\n  min-height: 50vh;\n  padding-top: 100px;\n"]);return fr=function(){return n},n}function pr(){var n=Object(u.a)([""]);return pr=function(){return n},n}var gr=w.b.div(pr()),xr=w.b.div(fr()),hr=w.b.div(jr()),mr=w.b.div(br()),Or=w.b.div(dr()),vr=w.b.div(lr()),wr=w.b.div(sr()),kr=w.b.div(ur()),yr=w.b.span(ar()),Cr=w.b.span(ir()),Sr=w.b.p(cr()),Ir=w.b.div(or()),Pr=w.b.img(rr()),$r=w.b.button(tr()),Nr=w.b.span(er()),Lr=w.b.button(nr()),Fr=w.b.div(Zt()),Mr=w.b.div(Vt()),qr=w.b.div(Kt(),(function(n){return n.bg}),Mr);function zr(){var n=Object(u.a)(["\n  mutation EditUser(\n    $profilePhoto: String\n    $intro: String\n    $username: String\n    $firstName: String\n    $lastName: String\n  ) {\n    EditUser(\n      profilePhoto: $profilePhoto\n      intro: $intro\n      username: $username\n      firstName: $firstName\n      lastName: $lastName\n    ) {\n      ok\n      err\n    }\n  }\n"]);return zr=function(){return n},n}var Er=Object(o.gql)(zr());function Ar(){var n=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n  border: 3px solid #eee;\n  border-radius: 4px;\n  height: 100px;\n  text-align: center;\n  margin-bottom: 25px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: center;\n"]);return Ar=function(){return n},n}function Ur(){var n=Object(u.a)(["\n  margin-top: 15px;\n  width: 100px;\n  padding: 10px 0;\n  border-radius: 4px;\n  border: none;\n  background-color: #3498db;\n  color: white;\n  text-align: center;\n  align-items: center;\n  cursor: pointer;\n  &:hover {\n    background-color: #2980b9;\n    transition: 0.2s linear;\n  }\n"]);return Ur=function(){return n},n}function Tr(){var n=Object(u.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return Tr=function(){return n},n}function Dr(){var n=Object(u.a)(["\n  padding: 12px 12px;\n  width: 300px;\n  border-radius: 4px;\n  border: none;\n  background-color: #e6e6e6;\n"]);return Dr=function(){return n},n}function Gr(){var n=Object(u.a)(["\n  width: 100px;\n  font-weight: 600;\n"]);return Gr=function(){return n},n}function Br(){var n=Object(u.a)(["\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  margin-bottom: 15px;\n"]);return Br=function(){return n},n}function Qr(){var n=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n  display: flex;\n  flex-direction: column;\n"]);return Qr=function(){return n},n}function Rr(){var n=Object(u.a)(["\n  border: none;\n  padding: 4px 6px;\n  &:hover {\n    background-color: lightgray;\n  }\n"]);return Rr=function(){return n},n}function Hr(){var n=Object(u.a)(["\n  display: flex;\n  width: 100%;\n  justify-content: flex-end;\n  margin-bottom: 40px;\n"]);return Hr=function(){return n},n}function Wr(){var n=Object(u.a)(["\n  background-color: white;\n  position: absolute;\n  margin: auto;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  width: 50%;\n  height: 60%;\n  z-index: 5;\n  padding: 50px 20px;\n  padding-top: 10px;\n  border-radius: 5px;\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);\n"]);return Wr=function(){return n},n}var Yr=w.b.div(Wr()),_r=w.b.div(Hr()),Xr=w.b.button(Rr()),Jr=w.b.div(Qr()),Kr=w.b.div(Br()),Vr=w.b.span(Gr()),Zr=w.b.input(Dr()),no=w.b.div(Tr()),eo=w.b.div(Ur()),to=w.b.div(Ar()),ro=function(n){var e=n.setPopup,t=n.me,i=Object(c.useState)(),a=Object($.a)(i,2),u=a[0],s=a[1],l=Object(c.useState)(!1),d=Object($.a)(l,2),b=d[0],j=d[1],f=Object(c.useState)(0),p=Object($.a)(f,2),g=p[0],x=p[1],h=On(""),m=Object($.a)(h,2),O=m[0],v=m[1],w=On(""),k=Object($.a)(w,2),y=k[0],C=k[1],S=On(""),I=Object($.a)(S,2),P=I[0],L=I[1],F=Object(c.useState)(""),M=Object($.a)(F,2),z=M[0],E=M[1],A=Object(Se.a)({accept:"image/png, image/jpeg"}),U=A.getRootProps,T=A.getInputProps,D=Object(o.useMutation)(Er,{variables:{firstName:O,lastName:y,intro:P,profilePhoto:z},onCompleted:function(n){var t=n.EditUser,r=t.ok,o=t.err;r?(N.b.success("User Data edited"),e(!1),window.location.reload()):console.log(o)}}),G=Object($.a)(D,1)[0];return Object(c.useEffect)((function(){b&&t&&u&&q.ref("/".concat(t.username,"/profile/").concat(u.name)).put(u).on("state_changed",(function(n){var e=Math.round(n.bytesTransferred/n.totalBytes*100);x(e)}),(function(n){return console.log(n)}),(function(){q.ref("/".concat(t.username,"/profile/")).child("".concat(u.name)).getDownloadURL().then((function(n){return E(n)}))}))}),[b,t,u]),Object(r.jsxs)(Yr,{children:[Object(r.jsx)(_r,{children:Object(r.jsx)(Xr,{onClick:function(){return e(!1)},children:"X"})}),Object(r.jsxs)(Jr,{children:[0===g?Object(r.jsxs)(to,Object(H.a)(Object(H.a)({},U()),{},{children:[Object(r.jsx)("input",Object(H.a)(Object(H.a)({},T()),{},{onChange:function(n){n.preventDefault(),n.target&&n.target.files&&null!==n.target&&n.target.files&&null!==n.target.files.length&&(s(n.target.files[0]),j(!0))}})),Object(r.jsx)(J,{}),"Click here or drag image to upload"]})):100===g?"Uploaded":Object(r.jsx)(Pn,{}),Object(r.jsxs)(Kr,{children:[Object(r.jsx)(Vr,{children:"First Name"}),Object(r.jsx)(Zr,{type:"text",placeholder:"First Name",value:O,onChange:v})]}),Object(r.jsxs)(Kr,{children:[Object(r.jsx)(Vr,{children:"Last Name"}),Object(r.jsx)(Zr,{type:"text",placeholder:"Last Name",value:y,onChange:C})]}),Object(r.jsxs)(Kr,{children:[Object(r.jsx)(Vr,{children:"Intro"}),Object(r.jsx)(Zr,{type:"text",placeholder:"Intro",value:P,onChange:L})]})]}),Object(r.jsx)(no,{children:Object(r.jsx)(eo,{onClick:function(){return G()},children:"Submit"})})]})};function oo(){var n=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: 50px;\n  font-size: 20px;\n"]);return oo=function(){return n},n}function co(){var n=Object(u.a)(["\n  &:not(:last-child) {\n    margin-bottom: 15px;\n    border-bottom: 2px solid #ccc;\n  }\n"]);return co=function(){return n},n}function io(){var n=Object(u.a)(["\n  text-decoration: none;\n"]);return io=function(){return n},n}function ao(){var n=Object(u.a)(["\n  padding-left: 35px;\n  color: #ccc;\n"]);return ao=function(){return n},n}function uo(){var n=Object(u.a)(["\n  padding-left: 30px;\n  font-weight: 600;\n  color: black;\n"]);return uo=function(){return n},n}function so(){var n=Object(u.a)(["\n  display: flex;\n  flex-direction: column;\n"]);return so=function(){return n},n}function lo(){var n=Object(u.a)(["\n  width: 50px;\n  height: 50px;\n  object-fit: cover;\n  border-radius: 10rem;\n"]);return lo=function(){return n},n}function bo(){var n=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n  border: 3px solid #eee;\n  border-radius: 4px;\n  height: 100px;\n  text-align: center;\n  margin-bottom: 25px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: center;\n"]);return bo=function(){return n},n}function jo(){var n=Object(u.a)(["\n  margin-top: 15px;\n  width: 100px;\n  padding: 10px 0;\n  border-radius: 4px;\n  border: none;\n  background-color: #3498db;\n  color: white;\n  text-align: center;\n  align-items: center;\n  cursor: pointer;\n  &:hover {\n    background-color: #2980b9;\n    transition: 0.2s linear;\n  }\n"]);return jo=function(){return n},n}function fo(){var n=Object(u.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return fo=function(){return n},n}function po(){var n=Object(u.a)(["\n  padding: 12px 12px;\n  width: 300px;\n  border-radius: 4px;\n  border: none;\n  background-color: #e6e6e6;\n"]);return po=function(){return n},n}function go(){var n=Object(u.a)(["\n  padding: 8px 0;\n  padding-left: 15px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  margin-bottom: 5px;\n  &:hover {\n    background-color: #eee;\n    transition: 0.2s linear;\n  }\n"]);return go=function(){return n},n}function xo(){var n=Object(u.a)(["\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n"]);return xo=function(){return n},n}function ho(){var n=Object(u.a)([""]);return ho=function(){return n},n}function mo(){var n=Object(u.a)(["\n  text-align: center;\n"]);return mo=function(){return n},n}function Oo(){var n=Object(u.a)(["\n  border: none;\n  padding: 4px 6px;\n  height: 22px;\n  width: 22px;\n  cursor: pointer;\n  &:hover {\n    background-color: lightgray;\n  }\n"]);return Oo=function(){return n},n}function vo(){var n=Object(u.a)(["\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n  margin-bottom: 10px;\n"]);return vo=function(){return n},n}function wo(){var n=Object(u.a)(["\n  background-color: white;\n  position: absolute;\n  margin: auto;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  width: 50%;\n  height: 60%;\n  z-index: 5;\n  padding: 50px 20px;\n  padding-top: 10px;\n  border-radius: 5px;\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);\n"]);return wo=function(){return n},n}var ko=w.b.div(wo()),yo=w.b.div(vo()),Co=w.b.button(Oo()),So=w.b.div(mo()),Io=w.b.h2(ho()),Po=w.b.div(xo()),$o=w.b.div(go()),No=(w.b.input(po()),w.b.div(fo()),w.b.div(jo()),w.b.div(bo()),w.b.img(lo())),Lo=w.b.div(so()),Fo=w.b.span(uo()),Mo=w.b.span(ao()),qo=Object(w.b)(k.c)(io()),zo=w.b.div(co()),Eo=w.b.div(oo()),Ao=function(n){var e=n.setPopup,t=n.me;return Object(c.useEffect)((function(){var n=function(){e(!1)};return document.addEventListener("click",n),function(){return document.removeEventListener("click",n)}}),[e]),t?Object(r.jsxs)(ko,{children:[Object(r.jsxs)(yo,{children:[Object(r.jsx)(So,{}),Object(r.jsx)(Io,{children:"Chat List"}),Object(r.jsx)(Co,{onClick:function(){return e(!1)},children:"X"})]}),Object(r.jsxs)(Po,{children:[Object(r.jsx)(zo,{children:t.chatFrom&&0===t.chatFrom.length?Object(r.jsx)(Eo,{children:"You haven't received any message yet"}):t.chatFrom&&t.chatFrom.map((function(n,e){return Object(r.jsx)(qo,{to:"/chat/".concat(n.id),children:Object(r.jsxs)($o,{children:[Object(r.jsx)(No,{src:n.to.profilePhoto,alt:"to"}),Object(r.jsxs)(Lo,{children:[Object(r.jsxs)(Fo,{children:["To : ",n.to.username]}),n.messages&&0!==n.messages.length?Object(r.jsxs)(Mo,{children:[n.messages[n.messages.length-1].user.username," : ",n.messages[n.messages.length-1].text]}):Object(r.jsx)(Mo,{children:"No message"})]})]})},e)}))}),Object(r.jsx)(zo,{children:t.chatTo&&0===t.chatTo.length?Object(r.jsx)(Eo,{children:"You haven't sent any message yet"}):t.chatTo&&t.chatTo.map((function(n,e){return Object(r.jsx)(qo,{to:"/chat/".concat(n.id),children:Object(r.jsxs)($o,{children:[Object(r.jsx)(No,{src:n.from.profilePhoto,alt:"to"}),Object(r.jsxs)(Lo,{children:[Object(r.jsxs)(Fo,{children:["From : ",n.from.username]}),n.messages&&0!==n.messages.length?Object(r.jsxs)(Mo,{children:[n.messages[n.messages.length-1].user.username," : ",n.messages[n.messages.length-1].text]}):Object(r.jsx)(Mo,{children:"No message"})]})]})},e)}))})]})]}):Object(r.jsx)(r.Fragment,{children:"loading"})};function Uo(){var n=Object(u.a)(["\n  text-decoration: none;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  cursor: pointer;\n"]);return Uo=function(){return n},n}function To(){var n=Object(u.a)(["\n  padding-left: 30px;\n  font-weight: 600;\n  color: black;\n"]);return To=function(){return n},n}function Do(){var n=Object(u.a)(["\n  width: 50px;\n  height: 50px;\n  object-fit: cover;\n  border-radius: 10rem;\n"]);return Do=function(){return n},n}function Go(){var n=Object(u.a)(["\n  width: 100%;\n  padding: 8px 0;\n  padding-left: 15px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  margin-bottom: 5px;\n  &:hover {\n    background-color: #eee;\n    transition: 0.2s linear;\n  }\n"]);return Go=function(){return n},n}function Bo(){var n=Object(u.a)(["\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n"]);return Bo=function(){return n},n}function Qo(){var n=Object(u.a)(["\n  text-transform: uppercase;\n"]);return Qo=function(){return n},n}function Ro(){var n=Object(u.a)(["\n  text-align: center;\n"]);return Ro=function(){return n},n}function Ho(){var n=Object(u.a)(["\n  border: none;\n  padding: 4px 6px;\n  height: 22px;\n  width: 22px;\n  cursor: pointer;\n  &:hover {\n    background-color: lightgray;\n  }\n"]);return Ho=function(){return n},n}function Wo(){var n=Object(u.a)(["\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n  margin-bottom: 10px;\n"]);return Wo=function(){return n},n}function Yo(){var n=Object(u.a)(["\n  background-color: white;\n  position: absolute;\n  margin: auto;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  width: 50%;\n  height: 60%;\n  z-index: 5;\n  padding: 50px 20px;\n  padding-top: 10px;\n  border-radius: 5px;\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);\n"]);return Yo=function(){return n},n}var _o=w.b.div(Yo()),Xo=w.b.div(Wo()),Jo=w.b.button(Ho()),Ko=w.b.div(Ro()),Vo=w.b.h2(Qo()),Zo=w.b.div(Bo()),nc=w.b.div(Go()),ec=w.b.img(Do()),tc=w.b.span(To()),rc=Object(w.b)(k.c)(Uo()),oc=function(n){var e=n.setFollowPopup,t=n.user,o=n.action;return Object(c.useEffect)((function(){var n=function(){e(!1)};return document.addEventListener("click",n),function(){return document.removeEventListener("click",n)}}),[e]),Object(r.jsxs)(_o,{children:[Object(r.jsxs)(Xo,{children:[Object(r.jsx)(Ko,{}),Object(r.jsxs)(Vo,{children:[o," List"]}),Object(r.jsx)(Jo,{onClick:function(){return e(!1)},children:"X"})]}),Object(r.jsx)(Zo,{children:"follower"===o&&t.followers&&t.followers.map((function(n,e){return Object(r.jsx)(rc,{to:"/profile/".concat(n.username),children:Object(r.jsxs)(nc,{children:[Object(r.jsx)(ec,{src:n.profilePhoto,alt:"user"}),Object(r.jsx)(tc,{children:n.username})]})},e)}))})]})},cc=function(n){var e=n.me,t=n.user,o=n.FollowingHandler,c=n.followingS,i=n.isMe,a=n.popup,u=n.setPopup,s=n.followPopup,l=n.setFollowPopup,d=n.chatPopup,b=n.setChatPopup,j=n.ChatHandler,p=n.action,g=n.setAction;return console.log(e),Object(r.jsxs)(gr,{children:[Object(r.jsx)(vn,{url:e.profilePhoto}),Object(r.jsxs)(xr,{children:[Object(r.jsxs)(hr,{children:[Object(r.jsxs)(mr,{children:[Object(r.jsx)(Or,{children:Object(r.jsx)(Pr,{src:t.profilePhoto,alt:"ProfilePhoto"})}),Object(r.jsxs)(Or,{children:[Object(r.jsxs)(vr,{children:[Object(r.jsx)(Nr,{children:t.username}),i?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)($r,{onClick:function(){return b(!0)},children:Object(r.jsx)(V,{})}),d?Object(r.jsx)(Ao,{setPopup:b,me:e}):""]}):Object(r.jsx)($r,{onClick:j,children:Object(r.jsx)(V,{})})]}),Object(r.jsxs)(vr,{children:[t.firstName," ",t.lastName]}),Object(r.jsx)(vr,{children:t.email}),Object(r.jsxs)(wr,{children:[Object(r.jsx)($r,{onClick:function(){return function(n){g(n),l(!0)}("follower")},children:Object(r.jsxs)(kr,{children:[Object(r.jsx)(yr,{children:"Follower"}),Object(r.jsx)(Cr,{children:t.followers?t.followers.length:"0"})]})}),""!==p&&s&&Object(r.jsx)(oc,{setFollowPopup:l,user:t,action:p})]}),Object(r.jsxs)(vr,{children:[i?Object(r.jsx)(Lr,{onClick:function(){return u(!0)},children:"Setting"}):Object(r.jsx)(Lr,{onClick:function(){return o(t.username)},children:c?"UNFOLLOW":"FOLLOW"}),a&&Object(r.jsx)(ro,{setPopup:u,me:e})]})]})]}),Object(r.jsxs)(mr,{children:[Object(r.jsx)(Or,{children:Object(r.jsx)(Sr,{children:t.intro})}),i?Object(r.jsx)(Or,{children:Object(r.jsx)(Ir,{onClick:function(){return v.cache.writeQuery({query:We,data:{isLoggedIn:!1}}),localStorage.removeItem("Bearer"),f(!1),void(window.location.href="/")},children:"Logout"})}):Object(r.jsx)(Or,{children:" "})]})]}),Object(r.jsxs)(Fr,{children:[t.posts&&0===t.posts.length&&"You have no post",t.posts&&t.posts.map((function(n,e){return Object(r.jsx)(qr,{bg:n.images[0].url,children:Object(r.jsx)(Mr,{children:Object(r.jsx)(Y,{})})},e)}))]})]})]})};function ic(){var n=Object(u.a)(["\n  mutation CreateChat($toId: Int!) {\n    CreateChat(toId: $toId) {\n      ok\n      err\n      chat {\n        id\n      }\n    }\n  }\n"]);return ic=function(){return n},n}function ac(){var n=Object(u.a)(["\n  mutation ToggleFollowing($username: String!, $action: String!) {\n    ToggleFollowing(username: $username, action: $action) {\n      ok\n      err\n    }\n  }\n"]);return ac=function(){return n},n}var uc=Object(o.gql)(ac()),sc=Object(o.gql)(ic()),lc=function(n){var e=n.match.params.username,t=Object(c.useState)(!1),i=Object($.a)(t,2),a=i[0],u=i[1],s=Object(c.useState)(),l=Object($.a)(s,2),d=l[0],b=l[1],j=Object(c.useState)(),f=Object($.a)(j,2),p=f[0],g=f[1],x=Object(c.useState)(),h=Object($.a)(x,2),m=h[0],O=h[1],v=Object(c.useState)(!1),w=Object($.a)(v,2),k=w[0],y=w[1],C=Object(c.useState)(!1),P=Object($.a)(C,2),N=P[0],L=P[1],F=Object(c.useState)(""),M=Object($.a)(F,2),q=M[0],z=M[1],E=Object(c.useState)(!1),A=Object($.a)(E,2),U=A[0],T=A[1];Object(o.useQuery)(B,{onCompleted:function(n){var e=n.Me,t=e.ok,r=e.err,o=e.user;t&&o?b(o):console.log(r)}});var D=Object(o.useQuery)(Q,{variables:{username:e},onCompleted:function(n){var e=n.SeeUser,t=e.ok,r=e.err,o=e.user;t&&o?(g(o),O(o.isFollowing)):console.log(r)}}).loading,G=Object(Jt.a)({forceRefresh:!0}),R=Object(o.useMutation)(uc,{onCompleted:function(n){var e=n.ToggleFollowing,t=e.ok,r=e.err;t?(O(!m),window.location.reload()):console.log(r)}}),H=Object($.a)(R,1)[0],W=Object(o.useMutation)(sc,{onCompleted:function(n){var e=n.CreateChat,t=e.ok,r=e.err,o=e.chat;t?o&&G.push("/chat/".concat(o.id)):console.log(r)}}),Y=Object($.a)(W,1)[0],_=function(){var n=Object(I.a)(S.a.mark((function n(){return S.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Y({variables:{toId:p.id}});case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return Object(c.useEffect)((function(){d&&p&&(d.id===p.id?u(!0):u(!1))}),[d,p,u]),!D&&p&&d?Object(r.jsx)(cc,{me:d,user:p,FollowingHandler:function(n){H({variables:{username:n,action:m?"UNFOLLOW":"FOLLOW"}})},followingS:m,isMe:a,popup:k,setPopup:y,followPopup:N,setFollowPopup:L,chatPopup:U,setChatPopup:T,ChatHandler:_,action:q,setAction:z}):Object(r.jsx)(r.Fragment,{children:"loading..."})};function dc(){var n=Object(u.a)(["\n  background-color: ",";\n  color: white;\n  padding: 10px 20px;\n  border-radius: 20px;\n  align-self: ",";\n  border-bottom-right-radius: ",";\n  border-bottom-left-radius: ",";\n  margin-bottom: 10px;\n"]);return dc=function(){return n},n}var bc=w.b.div(dc(),(function(n){return n.mine?n.theme.blueColor:n.theme.greyColor}),(function(n){return n.mine?"flex-end":"flex-start"}),(function(n){return n.mine?"0px":"20px"}),(function(n){return n.mine?"20px":"0px"})),jc=function(n){var e=n.text,t=n.mine;return Object(r.jsx)(bc,{mine:t,children:e})};function fc(){var n=Object(u.a)(["\nborder-top: 2px solid #ccc;\n  padding: 10px 25px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n "]);return fc=function(){return n},n}var pc=w.b.form(fc()),gc=function(n){var e=n.submitFn,t=n.children;return Object(r.jsx)(pc,{onSubmit:function(n){n.preventDefault(),e()},children:t})};function xc(){var n=Object(u.a)(["\n  width: 50px;\n  height: 50px;\n  object-fit: cover;\n  border-radius: 10rem;\n  margin-right: 25px;\n"]);return xc=function(){return n},n}function hc(){var n=Object(u.a)(["\n  text-decoration: none;\n  color: black;\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n"]);return hc=function(){return n},n}function mc(){var n=Object(u.a)(["\n  width: 100%;\n"]);return mc=function(){return n},n}function Oc(){var n=Object(u.a)(["\n  height: 70px;\n  margin: auto auto;\n"]);return Oc=function(){return n},n}function vc(){var n=Object(u.a)(["\n  padding: 8px 12px;\n  border: none;\n  background-color: #3498db;\n  border-radius: 4px;\n  color: white;\n  &:hover {\n    transition: 0.2s linear;\n    background-color: #2980b9;\n  }\n"]);return vc=function(){return n},n}function wc(){var n=Object(u.a)(["\n  width: 100%;\n  margin: 0 auto;\n  padding: 8px 10px;\n  border: none;\n  background-color: #eee;\n  border-radius: 4px;\n"]);return wc=function(){return n},n}function kc(){var n=Object(u.a)(["\n  border-top: 2px solid #ccc;\n  padding: 10px 25px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n"]);return kc=function(){return n},n}function yc(){var n=Object(u.a)(["\n  height: 400px;\n  height: 400px;\n  padding: 20px;\n  overflow: scroll;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n"]);return yc=function(){return n},n}function Cc(){var n=Object(u.a)(["\n  height: 50px;\n  display: flex;\n  align-items: center;\n  padding: 10px 25px;\n  border-bottom: 3px solid #ccc;\n  margin: 0 auto;\n  font-size: 16px;\n  font-weight: 600;\n"]);return Cc=function(){return n},n}function Sc(){var n=Object(u.a)(["\n  width: 70%;\n  min-width: 650px;\n  min-height: 500px;\n  margin: 0 auto;\n  margin-top: 50px;\n  border: 1px solid #ccc;\n"]);return Sc=function(){return n},n}function Ic(){var n=Object(u.a)([""]);return Ic=function(){return n},n}function Pc(){var n=Object(u.a)(["\n  height: 100vh;\n  width: 100vw;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return Pc=function(){return n},n}var $c=w.b.div(Pc()),Nc=w.b.div(Ic()),Lc=w.b.div(Sc()),Fc=w.b.div(Cc()),Mc=w.b.div(yc()),qc=(w.b.div(kc()),w.b.input(wc())),zc=(w.b.button(vc()),w.b.div(Oc())),Ec=Object(w.b)(gc)(mc()),Ac=Object(w.b)(k.c)(hc()),Uc=w.b.img(xc()),Tc=function(n){return n.map((function(n,e){return Object(r.jsx)(jc,Object(H.a)({},n),e)}))},Dc=function(n){var e=n.chat,t=n.me,o=n.messages,i=n.message,a=n.onChangeMessage,u=n.SendMessageMutation,s=(n.chatId,Object(c.useRef)(null));return Object(c.useEffect)((function(){s&&s.current&&(s.current.scrollTop=s.current.scrollHeight)}),[o]),Object(r.jsxs)(Nc,{children:[Object(r.jsx)(vn,{url:t.profilePhoto}),Object(r.jsxs)(Lc,{children:[Object(r.jsx)(Fc,{children:Object(r.jsxs)(Ac,{to:"/profile/".concat(e.to.username),children:[Object(r.jsx)(Uc,{src:t.id===e.to.id?e.from.profilePhoto:e.to.profilePhoto,alt:"to"}),"To : ",t.id===e.to.id?"".concat(e.from.username):"".concat(e.to.username)]})}),Object(r.jsx)(Mc,{ref:s,children:o&&Tc(o)}),Object(r.jsx)(zc,{children:Object(r.jsx)(Ec,{submitFn:u,children:Object(r.jsx)(qc,{placeholder:"Type message",value:i,onChange:a})})})]})]})};function Gc(){var n=Object(u.a)(["\n  mutation SendMessage($text: String!, $chatId: Int!) {\n    SendMessage(text: $text, chatId: $chatId) {\n      ok\n      err\n      message {\n        id\n        text\n        createdAt\n      }\n    }\n  }\n"]);return Gc=function(){return n},n}function Bc(){var n=Object(u.a)(["\n  subscription MessageSubscription {\n    MessageSubscription {\n      id\n      text\n      user {\n        id\n      }\n    }\n  }\n"]);return Bc=function(){return n},n}function Qc(){var n=Object(u.a)(["\n  query GetChatRoom($chatId: Int!) {\n    GetChatRoom(chatId: $chatId) {\n      ok\n      err\n      chat {\n        id\n        from {\n          id\n          username\n          profilePhoto\n        }\n        to {\n          id\n          username\n          profilePhoto\n        }\n        messages {\n          id\n          text\n          user {\n            id\n            username\n          }\n          createdAt\n        }\n      }\n    }\n  }\n"]);return Qc=function(){return n},n}var Rc=Object(o.gql)(Qc()),Hc=Object(o.gql)(Bc()),Wc=Object(o.gql)(Gc()),Yc=function(n){var e=n.match.params.chatId,t=Object(c.useState)(),i=Object($.a)(t,2),a=i[0],u=i[1],s=On(""),l=Object($.a)(s,3),d=l[0],b=l[1],j=l[2],f=Object(c.useState)(),p=Object($.a)(f,2),g=p[0],x=p[1],h=Object(c.useState)(),m=Object($.a)(h,2),O=m[0],v=m[1];Object(o.useQuery)(B,{fetchPolicy:"network-only",onCompleted:function(n){var e=n.Me,t=e.ok,r=e.err,o=e.user;t&&o?u(o):console.log(r)}});var w=Object(o.useQuery)(Rc,{fetchPolicy:"network-only",variables:{chatId:parseInt(e)},onCompleted:function(n){var e=n.GetChatRoom,t=e.ok,r=e.err,o=e.chat;if(t&&o&&o.messages)if(v(o),o.messages){var c=o.messages.map((function(n){return a&&a.id&&n&&n.user&&n.user.id?Object(H.a)(Object(H.a)({},n),{},{mine:a.id===n.user.id}):null}));x(c)}else console.log("no messages");else console.log(r)}}),k=w.loading,y=w.subscribeToMore;Object(c.useEffect)((function(){y({document:Hc,updateQuery:function(n,e){return e.subscriptionData.data?Object(H.a)({},n):n}})}),[y]),Object(o.useSubscription)(Hc,{fetchPolicy:"network-only",onSubscriptionComplete:function(){console.log("Listening new messages")},onSubscriptionData:function(n){var e=n.subscriptionData.data;if(e&&g&&a){var t=e.MessageSubscription;t&&x([].concat(Object(P.a)(g),[Object(H.a)(Object(H.a)({},t),{},{mine:a.id===t.user.id})]))}}});var C=Object(o.useMutation)(Wc,{variables:{text:d,chatId:parseInt(e)},onCompleted:function(n){var e=n.SendMessage,t=e.ok,r=e.err,o=e.message;t?(j(""),x([].concat(Object(P.a)(g),[Object(H.a)(Object(H.a)({},o),{},{mine:!0})]))):console.log(r)}}),S=Object($.a)(C,1)[0];return!k&&a&&O?Object(r.jsx)(Dc,{chat:O,me:a,messages:g,message:d,onChangeMessage:b,SendMessageMutation:S,chatId:parseInt(e)}):Object(r.jsx)($c,{children:Object(r.jsx)(Pn,{})})},_c=function(){return Object(r.jsxs)(y.d,{children:[Object(r.jsx)(y.b,{exact:!0,path:"/",component:Re}),Object(r.jsx)(y.b,{path:"/profile/:username",component:lc}),Object(r.jsx)(y.b,{path:"/chat/:chatId",component:Yc}),Object(r.jsx)(y.a,{from:"*",to:"/"})]})},Xc=function(){return Object(r.jsxs)(y.d,{children:[Object(r.jsx)(y.b,{exact:!0,path:"/",component:Xt}),Object(r.jsx)(y.a,{from:"*",to:"/"})]})},Jc=function(n){var e=n.isLoggedIn;return Object(r.jsx)(k.a,{children:e?Object(r.jsx)(_c,{}):Object(r.jsx)(Xc,{})})},Kc={blueColor:"#3498db",greyColor:"#7f8c8d",yellowColor:"#f1c40f",greenColor:"#1abc9c"};t(153);function Vc(){var n=Object(u.a)(["\nquery IsLoggedIn{\n  isLoggedIn @client\n}\n"]);return Vc=function(){return n},n}var Zc=Object(o.gql)(Vc()),ni=Object(c.createContext)(null),ei=function(){var n=Object(o.useQuery)(Zc).data.isLoggedIn;return Object(r.jsxs)(ni.Provider,{value:n,children:[Object(r.jsx)(w.a,{theme:Kc,children:Object(r.jsx)(k.b,{children:Object(r.jsx)(Jc,{isLoggedIn:n})})}),Object(r.jsx)(N.a,{draggable:!0,position:"bottom-center"})]})};a.a.render(Object(r.jsx)(o.ApolloProvider,{client:v,children:Object(r.jsx)(ei,{})}),document.getElementById("root"))}},[[154,1,2]]]);
//# sourceMappingURL=main.8ff9d558.chunk.js.map